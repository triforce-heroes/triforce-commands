import{existsSync as o,readFileSync as e,writeFileSync as r}from"node:fs";import{fatal as t}from"@triforce-heroes/triforce-core/Console";import{loadEngineDriver as s}from"../drivers/index.js";import{EntryCommand as n}from"../index.js";export function ExtractCommand(i){let f=s(i);void 0===f&&t(`Unsupported engine driver: ${i}`),o("./publishable.json")||t("publishable.json not found"),process.stdout.write("Extracting commands... ");let d=new Set;for(let o of JSON.parse(e("./publishable.json","utf8")))for(let e of Object.values(o.sources))for(let o of f.parseRaw(e).entries)o instanceof n&&d.add(o.command);r("./commands.json",JSON.stringify([...d].sort(),null,2)),process.stdout.write("DONE")}